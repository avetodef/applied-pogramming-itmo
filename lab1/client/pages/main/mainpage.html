<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
  <head>
    <title>Main page</title>
    <link rel="stylesheet" href="main-style.css" />
  </head>
  <body>
    <div class="file-upload-container">
      <p>Upload a file to SQL server</p>
      <form
        class="sql-form"
        id="file-form"
        method="POST"
        onsubmit="transformFormData();"
        enctype="multipart/form-data"
      >
        <label for="server">SQL server name</label> <br />
        <input type="text" id="server" name="server" /> <br />

        <label for="server_login">Login</label> <br />
        <input type="text" id="server_login" name="server_login" /> <br />

        <label for="password">Password</label><br />
        <input type="password" id="password" name="password" /> <br />

        <label for="db_name">Database name</label><br />
        <input type="text" id="db_name" name="db_name" /> <br />

        <label for="table_name">Table name</label><br />
        <input type="text" id="table_name" name="table_name" /> <br />

        <label for="file">Upload a file</label> <br />
        <input
          type="file"
          id="file"
          name="file"
          value="Upload"
        />
        <br />
        <input
          type="submit"
          id="submit-button"
          name="submit_button"
          class="submit_button"
          value="Upload file to database"
        />
      </form>
    </div>

    <script >
      function transformFormData() {
        var form = document.getElementById("file-form");
        var qs = new URLSearchParams(new FormData(form)).toString();
        form.action = 'http://127.0.0.1:8000/upload?' + qs;
      }

      // const file = document.getElementById("file");
      // const server = document.getElementById("sql-name");
      // const login = document.getElementById("sql-login");
      // const password = document.getElementById("sql-password");
      // const db_name = document.getElementById("db-name");
      // const table_name = document.getElementById("table-name");

      // const send = document.getElementById("submit-button");
      // const upload = document.getElementById("file-button");

      // send.addEventListener("click", async (e) => {
      //   e.preventDefault();
      //   const payload = {
      //     login: login.value,
      //     password: password.value,
      //   };

      //   const response = await fetch("http://127.0.0.1:8000/connect", {
      //     method: "POST",
      //     headers: {
      //       accept: "application/json",
      //       "Content-Type": "application/json",
      //     },
      //     body: JSON.stringify(payload),
      //   }).then((response) => {
      //     if (response.status === 401) {
      //       alert("Incorrect username or password");
      //     }
      //     if (response.status === 200) {
      //       alrt("NORM!");
      //     }
      //   });
      // });

      // upload.addEventListener("click", async (e) => {
      //   e.preventDefault();
      //   const payload = {
      //     login: login.value,
      //     password: password.value,
      //   };

      //   const response = await fetch("http://127.0.0.1:8000/upload", {
      //     method: "POST",
      //     headers: {
      //       accept: "application/json",
      //       "Content-Type": "application/json",
      //     },
      //     body: JSON.stringify(payload),
      //   }).then((response) => {
      //     if (response.status === 401) {
      //       alert("Incorrect username or password");
      //     }
      //     if (response.status === 200) {
      //       alrt("DONE!");
      //     }
      //   });
      // });
    </script>
  </body>
</html>
